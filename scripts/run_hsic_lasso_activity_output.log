INFO:__main__:Starting processing for MICE
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/pyHSICLasso-1.4.2-py3.9.egg/pyHSICLasso/api.py:107: RuntimeWarning: B 20 must be an exact divisor of the number of samples 756. Number of blocks 37.8 will be approximated to 37.
#########################################
################ dataset=MICE, response_type=categorical ################
#########################################
X shape: (1080, 77), Y shape: (1080,)
X_train is [[0.99902916 0.99905419 0.99993265 ... 0.39671201 0.99999809 0.07921121]
 [0.99905509 0.99913335 0.99990088 ... 0.99999398 0.9999935  0.22949012]
 [0.99907398 0.99917573 0.99991536 ... 0.99999285 0.9999938  0.77218121]
 ...
 [0.99915087 0.99925888 0.99997741 ... 0.99999326 0.         0.68910486]
 [0.99898684 0.99902785 0.99990833 ... 0.99999523 0.78721988 0.38192409]
 [0.99910021 0.99908382 0.99991852 ... 0.99999517 0.99999511 0.26431772]]
y_train is [2 2 4 6 0 1 3 1 1 6 6 5 3 1 2 4 0 0 5 1 3 7 6 7 3 1 3 1 4 1 0 2 0 4 2 3 1
 3 7 7 0 5 7 2 1 5 4 7 2 1 7 2 7 5 4 3 5 5 2 0 4 2 7 1 7 6 2 4 7 7 0 7 5 4
 5 6 4 2 5 6 0 7 7 5 2 3 7 7 4 3 2 1 2 6 7 2 0 5 2 5 2 7 3 1 1 5 3 6 2 1 6
 6 0 3 6 0 1 0 5 3 4 4 7 3 3 6 3 5 1 1 0 3 7 3 0 4 1 1 3 1 6 7 3 3 7 2 4 1
 3 5 2 7 6 2 6 2 2 5 0 6 2 2 5 4 5 2 7 4 3 2 7 0 1 2 1 5 3 1 7 7 5 6 6 1 6
 7 7 0 7 7 1 4 5 5 6 7 4 5 3 2 1 4 7 7 1 7 4 0 4 5 4 6 6 3 0 7 0 0 1 0 1 7
 1 2 7 0 3 1 2 5 1 3 7 0 5 5 2 3 4 5 6 1 6 6 7 7 1 4 2 6 6 4 5 4 1 7 2 3 6
 5 3 2 0 6 7 5 0 1 7 3 5 3 5 1 3 0 7 6 7 6 6 0 2 5 7 6 1 4 0 6 6 5 0 3 1 0
 7 3 0 2 2 3 7 2 0 7 0 4 5 0 5 0 7 3 1 2 0 6 3 3 5 4 6 2 5 7 3 2 5 1 0 3 0
 4 1 3 7 5 4 1 5 0 0 0 4 5 3 6 2 7 4 0 2 7 6 7 1 1 4 6 2 7 5 2 6 7 2 1 5 6
 7 1 5 7 5 5 1 6 1 4 0 4 3 3 6 0 0 6 5 7 6 4 5 0 3 3 0 5 3 5 1 6 0 6 3 2 1
 4 2 0 4 7 1 6 4 3 7 7 4 1 7 3 4 1 1 3 1 7 5 7 3 6 0 6 6 0 7 1 6 6 5 6 5 7
 5 6 0 0 7 0 0 1 1 2 6 3 2 6 4 2 6 1 7 0 6 7 3 6 5 3 5 5 3 1 3 3 0 1 1 3 7
 7 7 3 2 7 0 5 7 5 7 7 1 1 4 7 5 5 6 7 7 0 0 7 7 0 2 1 1 2 2 6 3 7 0 5 6 1
 3 5 7 0 0 5 6 6 5 1 7 6 7 4 1 1 3 2 5 7 2 5 4 5 7 6 1 4 1 4 6 2 1 7 0 4 3
 6 6 3 7 2 7 5 0 5 3 3 1 4 7 4 2 3 5 1 3 0 2 2 1 1 6 3 5 7 7 2 7 1 7 1 2 4
 0 3 7 2 4 6 3 0 4 2 7 4 1 5 0 6 2 2 0 0 4 1 5 2 2 2 5 3 1 5 3 0 7 3 1 2 0
 0 2 4 5 6 5 1 7 2 7 0 5 1 7 1 0 7 2 6 4 3 0 0 6 5 0 6 5 7 3 2 1 6 0 5 6 0
 0 4 6 7 4 6 3 1 3 5 6 1 0 5 0 7 3 5 1 0 6 1 4 1 0 5 3 7 7 7 6 6 6 7 2 5 2
 2 3 5 1 6 6 0 7 0 0 2 5 2 5 5 5 5 7 6 4 6 2 1 5 4 5 6 1 0 4 0 0 3 0 2 2 3
 2 7 5 2 3 2 2 2 6 7 0 3 4 7 1 7]
Block HSIC Lasso B = 20.
M set to 3.
Using Gaussian kernel for the features, Delta kernel for the outcomes.
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/pyHSICLasso-1.4.2-py3.9.egg/pyHSICLasso/nlars.py:77: RuntimeWarning: divide by zero encountered in divide
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/pyHSICLasso-1.4.2-py3.9.egg/pyHSICLasso/nlars.py:77: RuntimeWarning: invalid value encountered in divide
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/seaborn/matrix.py:560: UserWarning: Clustering large matrix with scipy. Installing `fastcluster` may give better performance.
  warnings.warn(msg)
INFO:__main__:Successfully completed MICE
INFO:__main__:Starting processing for Activity
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/pyHSICLasso-1.4.2-py3.9.egg/pyHSICLasso/api.py:107: RuntimeWarning: B 20 must be an exact divisor of the number of samples 6433. Number of blocks 321.65 will be approximated to 321.
/Users/amber/opt/anaconda3/envs/hsic_lasso/lib/python3.9/site-packages/seaborn/matrix.py:560: UserWarning: Clustering large matrix with scipy. Installing `fastcluster` may give better performance.
  warnings.warn(msg)
WARNING:root:Two scores are not the same: [0.9063454360366474, 0.9060061079063454]
INFO:__main__:Successfully completed Activity
INFO:__main__:Duration for running hsic_lasso: 916.006631 seconds
y_train.shape is (756,)
y_test.shape is (216,)
Number of selected features: 46
X_train.shape is (756, 77)
Average sparsity: 0.597
calculating cross entropy loss for categorical response
loss is 0.034471798442542355
loss_baseline is 0.26159623554796624
Relative loss: 0.132
Test accuracy in MICE, type=categorical: [0.9259259259259259, 0.9259259259259259]
Duration for running MICE, type=categorical: 75.8762481212616 seconds
#########################################
################ dataset=Activity, response_type=categorical ################
#########################################
loading activity
Data loaded...
Data shapes:
(7352, 561) (7352,)
(2947, 561) (2947,)
X_train is [[0.63712747 0.48552312 0.42220838 ... 0.16629977 0.66244122 0.52764906]
 [0.59041024 0.4988596  0.46351307 ... 0.03155312 0.56959216 0.51693578]
 [0.6393103  0.51410367 0.47426101 ... 0.00981197 0.54112963 0.51243406]
 ...
 [0.63917724 0.49002379 0.44788811 ... 0.08429559 0.60222106 0.48405597]
 [0.6294605  0.48701629 0.44169473 ... 0.10681385 0.62281443 0.50536804]
 [0.64107746 0.49407155 0.45465063 ... 0.10334717 0.61717941 0.53115155]]
y_train is [1 0 3 ... 4 1 3]
Block HSIC Lasso B = 20.
M set to 3.
Using Gaussian kernel for the features, Delta kernel for the outcomes.
y_train.shape is (6433,)
y_test.shape is (2947,)
Number of selected features: 50
X_train.shape is (6433, 561)
Average sparsity: 0.089
calculating cross entropy loss for categorical response
loss is 0.04096994730246574
loss_baseline is 0.29836261051889673
Relative loss: 0.137
Test accuracy in Activity, type=categorical: [0.9063454360366474, 0.9060061079063454]
Duration for running Activity, type=categorical: 840.0345640182495 seconds
